<!DOCTYPE html>
<html>

<head>
    <!-- <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet"> -->
    <CSS></CSS>
    <!-- <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script> -->
    <JS></JS>
</head>

<body>
    <div id="editor-container">
    </div>
    <script>
        /*const prevFn = window.postMessage;
        window.postMessage = (...arg) => {
            const msg = JSON.stringify(arg.shift());
            arg.unshift(msg);
            prevFn(...arg);
        }*/

        var quill = new Quill('#editor-container', {
            //readOnly: true,
            modules: {
                //toolbar: false,
                toolbar: [
                    [{ header: [1, 2, false] }],
                    ['bold', 'italic', 'underline'],
                    ['image', 'video', 'code-block']
                ]
            },
            theme: 'snow' // or 'bubble'
        });

        quill.setContents({ "ops": [{ "insert": { "video": "https://www.youtube.com/embed/xvVsaU9l-3I?showinfo=0" } }, { "insert": "\n" }] });

        //quill.disable();
        quill.on('text-change', function (delta, oldDelta, source) {
            window.postMessage(JSON.stringify(quill.getText(0, quill.getLength())));
            window.postMessage(JSON.stringify(quill.getContents(0, quill.getLength())));
            if (source == 'api') {
                console.log("An API call triggered this change.");
            } else if (source == 'user') {
                console.log("A user action triggered this change.");
            }
        });
    </script>
</body>

</html>